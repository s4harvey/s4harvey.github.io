---
title: "&#32;"
output:
  html_document:
    css: "styles.css"
    theme: "lumen"
    df_print: paged
---


```{r setup, include=FALSE, warning= FALSE}
knitr::opts_chunk$set(echo=FALSE)

library(dplyr)
library(ggplot2)
library(gridExtra)
library(DT)
library(crosstalk)
library(here)
library(fontawesome) #contains some icons
library(lubridate) #used to round date
library('wesanderson')

screening_data <- read.csv(here("Data", "screening_data.csv"))
patient_data <- read.csv(here("Data", "patient_data.csv"))

screening_data <- screening_data %>% mutate(screen_hospital = ifelse(screen_hospital == 1, "Royal Brisbane and Women's Hospital", ifelse(screen_hospital == 2, "Surgical, Treatment and Rehabilitation Service", ifelse(screen_hospital ==3, "Brighton Rehabilitation Unit", ifelse(screen_hospital == 4, "Caboolture Hospital", ifelse(screen_hospital ==5, "Redcliffe Hospital", ifelse(screen_hospital==6, "St Vincent's Hospital Melbourne - Acute Fitzroy", ifelse(screen_hospital==7, "St Vincent's Hospital Melbourne - Rehab Fitzroy", ifelse(screen_hospital ==8, "St Vincent's Hospital Melbourne - Rehab SGHS", ifelse(screen_hospital==9, "Monash Medical Centre", ifelse(screen_hospital==10, "Kingston Centre", ifelse(screen_hospital ==11, "Sir Charles Gairdner Hospital", ifelse(screen_hospital==12, "Osborne Park Hospital", ifelse(screen_hospital ==13, "Fiona Stanley Hospital",ifelse(screen_hospital==14, "Fremantle Hospital",ifelse(screen_hospital==15, "Casey Hospital",ifelse(screen_hospital==16, "SVHM - Rehab@Home", NA)))))))))))))))))

patient_data <- patient_data %>% mutate(admhospital = ifelse(admhospital == 1, "Royal Brisbane and Women's Hospital", ifelse(admhospital == 2, "Surgical, Treatment and Rehabilitation Service", ifelse(admhospital == 3, "Brighton Rehabilitation Unit", ifelse(admhospital == 4, "Caboolture Hospital", ifelse(admhospital == 5, "Redcliffe Hospital", ifelse(admhospital == 6, "St Vincent's Hospital Melbourne - Acute", ifelse(admhospital == 7, "St Vincent's Hospital Melbourne - Rehab Fitzroy", ifelse(admhospital == 8, "St Vincent's Hospital Melbourne - Rehab SGHS", ifelse(admhospital == 9, "Monash Medical Centre", ifelse(admhospital == 10, "Kingston Centre", ifelse(admhospital == 11, "Sir Charles Gairdner Hospital", ifelse(admhospital == 12, "Osborne Park Hospital", ifelse(admhospital == 13, "Fiona Stanley Hospital",ifelse(admhospital == 14, "Fremantle Hospital",ifelse(admhospital == 15, "STARS Day Hospital",ifelse(admhospital == 16, "Casey Hospital",ifelse(admhospital == 17, "SVHM - Rehab@Home", NA)))))))))))))))))) %>% mutate(redcap_event_name = ifelse(redcap_event_name == "inpatient_acute_arm_1","Acute",ifelse(redcap_event_name == "inpatient_rehabsub_arm_1","Rehab","Community"))) %>% filter(grepl('-',participant_id))
```

```{r}

# create event dataframes
InpatientAcute <- patient_data %>% filter(redcap_event_name == "Acute")
InpatientRehab <- patient_data %>% filter(redcap_event_name == "Rehab")
Community <- patient_data %>% filter(redcap_event_name == "Community")

# Create a summary table
total_screened <- nrow(screening_data)
total_recruited <- sum(screening_data$gained_consent == 1, na.rm = TRUE)
#completed_study <- sum(patient_data$end_of_study_complete == 2, na.rm = TRUE)
completed_study <- sum(InpatientRehab$end_of_study_complete == 2, na.rm = TRUE)
recruit_summary_table <- data.frame(
  Participants = c("Recruited", "Completed"),
  Total = c(total_recruited, completed_study)
)

# Create a summary table showing the number of completed COS measures, anchors and patient experience questionnaires across all sites

total_pre_wab <- patient_data %>% filter(wabr_base_comp == 1) %>% nrow
total_post_wab <- patient_data %>% filter(wabr_post_comp == 1) %>% nrow
total_pre_scenario <- patient_data %>% filter(scenario_base_comp == 1) %>% nrow
total_post_scenario <- patient_data %>% filter(scenario_post_comp == 1) %>% nrow
total_pre_saqol <- patient_data %>% filter(saqol_base_comp == 1) %>% nrow
total_post_saqol <- patient_data %>% filter(saqol_post_comp == 1) %>% nrow
total_pre_ghq12 <- patient_data %>% filter(ghq12_base_comp == 1) %>% nrow
total_post_ghq12 <- patient_data %>% filter(ghq12_post_comp == 1) %>% nrow

cos_summary_table <- data.frame(
  Outcome = c("WABR", "Scenario Test", "SAQoL-39", "GHQ-12"),
  Pre = c(total_pre_wab, total_pre_scenario, total_pre_saqol, total_pre_ghq12),
  Post = c(total_post_wab, total_post_scenario, total_post_saqol, total_post_ghq12)
)

total_clin_anch_lang <- patient_data %>% filter(clinanchor_lang_comp == 1) %>% nrow
total_clin_anch_comm <- patient_data %>% filter(clinanchor_comm_comp == 1) %>% nrow
total_clin_anch_qol <- patient_data %>% filter(clinanchor_qol_comp == 1) %>% nrow
total_clin_anch_ewb <- patient_data %>% filter(clinanchor_ewb_comp == 1) %>% nrow

total_pt_anch_lang <- patient_data %>% filter(ptanchor_lang_comp == 1) %>% nrow
total_pt_anch_comm <- patient_data %>% filter(ptanchor_comm_comp == 1) %>% nrow
total_pt_anch_qol <- patient_data %>% filter(ptanchor_qol_comp == 1) %>% nrow
total_pt_anch_ewb <- patient_data %>% filter(ptanchor_ewb_comp == 1) %>% nrow

anchor_summary_table <- data.frame(
  Construct = c("Language", "Communication", "Quality of life", "Emotional wellbeing"),
  Clinician = c(total_clin_anch_lang, total_clin_anch_comm, total_clin_anch_qol, total_clin_anch_ewb),
  Patient = c(total_pt_anch_lang, total_pt_anch_comm, total_pt_anch_qol, total_pt_anch_ewb)
)

total_exp_survey <- patient_data %>% filter(pt_q_completed == 1) %>% nrow


sites <- data.frame(admhospital = c("Royal Brisbane and Women's Hospital", "Surgical, Treatment and Rehabilitation Service", "Brighton Rehabilitation Unit", "Caboolture Hospital", "Redcliffe Hospital", "St Vincent's Hospital Melbourne - Acute Fitzroy", "St Vincent's Hospital Melbourne - Rehab Fitzroy", "St Vincent's Hospital Melbourne - Rehab SGHS",  "Monash Medical Centre", "Kingston Centre",  "Sir Charles Gairdner Hospital",  "Osborne Park Hospital", "Fiona Stanley Hospital", "Fremantle Hospital", "STARS Day Hospital", "Casey Hospital", "SVHM - Rehab@Home"))

site_count <- merge(sites, patient_data%>%filter(!is.na(admhospital)) %>% group_by(admhospital, participant_id)%>% mutate(rn = row_number()) %>% filter(rn == 1)%>% ungroup()%>% count(admhospital), by ="admhospital", all.x = TRUE)
site_count <- merge(site_count, InpatientAcute %>% count(admhospital), by ="admhospital", all.x = TRUE)
site_count <- merge(site_count, InpatientRehab %>% count(admhospital), by ="admhospital", all.x = TRUE)
colnames(site_count) <- c("Site","all","acute","rehab")
site_count <- site_count %>% replace(is.na(.), 0)


# RBWH
pre_1 <- patient_data %>% filter(admhospital == "Royal Brisbane and Women's Hospital" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_1 <- patient_data %>% filter(admhospital == "Royal Brisbane and Women's Hospital" & wabr_base_comp == 1) %>% nrow
pre_st_1 <- patient_data %>% filter(admhospital == "Royal Brisbane and Women's Hospital" & scenario_base_comp == 1) %>% nrow
pre_saq_1 <- patient_data %>% filter(admhospital == "Royal Brisbane and Women's Hospital" & saqol_base_comp == 1) %>% nrow
pre_ghq_1 <- patient_data %>% filter(admhospital == "Royal Brisbane and Women's Hospital" & ghq12_base_comp == 1) %>% nrow

post_1 <- patient_data %>% filter(admhospital == "Royal Brisbane and Women's Hospital" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_1 <- patient_data %>% filter(admhospital == "Royal Brisbane and Women's Hospital" & wabr_post_comp == 1) %>% nrow
post_st_1 <- patient_data %>% filter(admhospital == "Royal Brisbane and Women's Hospital" & scenario_post_comp == 1) %>% nrow
post_saq_1 <- patient_data %>% filter(admhospital == "Royal Brisbane and Women's Hospital" & saqol_post_comp == 1) %>% nrow
post_ghq_1 <- patient_data %>% filter(admhospital == "Royal Brisbane and Women's Hospital" & ghq12_post_comp == 1) %>% nrow

# STARS
pre_2 <- patient_data %>% filter(admhospital == "Surgical, Treatment and Rehabilitation Service" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_2 <- patient_data %>% filter(admhospital == "Surgical, Treatment and Rehabilitation Service" & wabr_base_comp == 1) %>% nrow
pre_st_2 <- patient_data %>% filter(admhospital == "Surgical, Treatment and Rehabilitation Service" & scenario_base_comp == 1) %>% nrow
pre_saq_2 <- patient_data %>% filter(admhospital == "Surgical, Treatment and Rehabilitation Service" & saqol_base_comp == 1) %>% nrow
pre_ghq_2 <- patient_data %>% filter(admhospital == "Surgical, Treatment and Rehabilitation Service" & ghq12_base_comp == 1) %>% nrow

post_2 <- patient_data %>% filter(admhospital == "Surgical, Treatment and Rehabilitation Service" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_2 <- patient_data %>% filter(admhospital == "Surgical, Treatment and Rehabilitation Service" & wabr_post_comp == 1) %>% nrow
post_st_2 <- patient_data %>% filter(admhospital == "Surgical, Treatment and Rehabilitation Service" & scenario_post_comp == 1) %>% nrow
post_saq_2 <- patient_data %>% filter(admhospital == "Surgical, Treatment and Rehabilitation Service" & saqol_post_comp == 1) %>% nrow
post_ghq_2 <- patient_data %>% filter(admhospital == "Surgical, Treatment and Rehabilitation Service" & ghq12_post_comp == 1) %>% nrow

# Brighton
pre_3 <- patient_data %>% filter(admhospital == "Brighton Rehabilitation Unit" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_3 <- patient_data %>% filter(admhospital == "Brighton Rehabilitation Unit" & wabr_base_comp == 1) %>% nrow
pre_st_3 <- patient_data %>% filter(admhospital == "Brighton Rehabilitation Unit" & scenario_base_comp == 1) %>% nrow
pre_saq_3 <- patient_data %>% filter(admhospital == "Brighton Rehabilitation Unit" & saqol_base_comp == 1) %>% nrow
pre_ghq_3 <- patient_data %>% filter(admhospital == "Brighton Rehabilitation Unit" & ghq12_base_comp == 1) %>% nrow

post_3 <- patient_data %>% filter(admhospital == "Brighton Rehabilitation Unit" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_3 <- patient_data %>% filter(admhospital == "Brighton Rehabilitation Unit" & wabr_post_comp == 1) %>% nrow
post_st_3 <- patient_data %>% filter(admhospital == "Brighton Rehabilitation Unit" & scenario_post_comp == 1) %>% nrow
post_saq_3 <- patient_data %>% filter(admhospital == "Brighton Rehabilitation Unit" & saqol_post_comp == 1) %>% nrow
post_ghq_3 <- patient_data %>% filter(admhospital == "Brighton Rehabilitation Unit" & ghq12_post_comp == 1) %>% nrow

# Caboolture
pre_4 <- patient_data %>% filter(admhospital == "Caboolture Hospital" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_4 <- patient_data %>% filter(admhospital == "Caboolture Hospital" & wabr_base_comp == 1) %>% nrow
pre_st_4 <- patient_data %>% filter(admhospital == "Caboolture Hospital" & scenario_base_comp == 1) %>% nrow
pre_saq_4 <- patient_data %>% filter(admhospital == "Caboolture Hospital" & saqol_base_comp == 1) %>% nrow
pre_ghq_4 <- patient_data %>% filter(admhospital == "Caboolture Hospital" & ghq12_base_comp == 1) %>% nrow

post_4 <- patient_data %>% filter(admhospital == "Caboolture Hospital" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_4 <- patient_data %>% filter(admhospital == "Caboolture Hospital" & wabr_post_comp == 1) %>% nrow
post_st_4 <- patient_data %>% filter(admhospital == "Caboolture Hospital" & scenario_post_comp == 1) %>% nrow
post_saq_4 <- patient_data %>% filter(admhospital == "Caboolture Hospital" & saqol_post_comp == 1) %>% nrow
post_ghq_4 <- patient_data %>% filter(admhospital == "Caboolture Hospital" & ghq12_post_comp == 1) %>% nrow

# Redcliffe
pre_5 <- patient_data %>% filter(admhospital == "Redcliffe Hospital" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_5 <- patient_data %>% filter(admhospital == "Redcliffe Hospital" & wabr_base_comp == 1) %>% nrow
pre_st_5 <- patient_data %>% filter(admhospital == "Redcliffe Hospital" & scenario_base_comp == 1) %>% nrow
pre_saq_5 <- patient_data %>% filter(admhospital == "Redcliffe Hospital" & saqol_base_comp == 1) %>% nrow
pre_ghq_5 <- patient_data %>% filter(admhospital == "Redcliffe Hospital" & ghq12_base_comp == 1) %>% nrow

post_5 <- patient_data %>% filter(admhospital == "Redcliffe Hospital" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_5 <- patient_data %>% filter(admhospital == "Redcliffe Hospital" & wabr_post_comp == 1) %>% nrow
post_st_5 <- patient_data %>% filter(admhospital == "Redcliffe Hospital" & scenario_post_comp == 1) %>% nrow
post_saq_5 <- patient_data %>% filter(admhospital == "Redcliffe Hospital" & saqol_post_comp == 1) %>% nrow
post_ghq_5 <- patient_data %>% filter(admhospital == "Redcliffe Hospital" & ghq12_post_comp == 1) %>% nrow

# St Vincent Acute
pre_6 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Acute Fitzroy" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_6 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Acute Fitzroy" & wabr_base_comp == 1) %>% nrow
pre_st_6 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Acute Fitzroy" & scenario_base_comp == 1) %>% nrow
pre_saq_6 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Acute Fitzroy" & saqol_base_comp == 1) %>% nrow
pre_ghq_6 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Acute Fitzroy" & ghq12_base_comp == 1) %>% nrow

post_6 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Acute Fitzroy" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_6 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Acute Fitzroy" & wabr_post_comp == 1) %>% nrow
post_st_6 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Acute Fitzroy" & scenario_post_comp == 1) %>% nrow
post_saq_6 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Acute Fitzroy" & saqol_post_comp == 1) %>% nrow
post_ghq_6 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Acute Fitzroy" & ghq12_post_comp == 1) %>% nrow

# St Vincent Rehab Fitzroy
pre_7 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab Fitzroy" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_7 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab Fitzroy" & wabr_base_comp == 1) %>% nrow
pre_st_7 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab Fitzroy" & scenario_base_comp == 1) %>% nrow
pre_saq_7 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab Fitzroy" & saqol_base_comp == 1) %>% nrow
pre_ghq_7 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab Fitzroy" & ghq12_base_comp == 1) %>% nrow

post_7 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab Fitzroy" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_7 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab Fitzroy" & wabr_post_comp == 1) %>% nrow
post_st_7 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab Fitzroy" & scenario_post_comp == 1) %>% nrow
post_saq_7 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab Fitzroy" & saqol_post_comp == 1) %>% nrow
post_ghq_7 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab Fitzroy" & ghq12_post_comp == 1) %>% nrow

# St Vincent Rehab SGHS
pre_8 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab SGHS" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_8 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab SGHS" & wabr_base_comp == 1) %>% nrow
pre_st_8 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab SGHS" & scenario_base_comp == 1) %>% nrow
pre_saq_8 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab SGHS" & saqol_base_comp == 1) %>% nrow
pre_ghq_8 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab SGHS" & ghq12_base_comp == 1) %>% nrow

post_8 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab SGHS" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_8 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab SGHS" & wabr_post_comp == 1) %>% nrow
post_st_8 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab SGHS" & scenario_post_comp == 1) %>% nrow
post_saq_8 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab SGHS" & saqol_post_comp == 1) %>% nrow
post_ghq_8 <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab SGHS" & ghq12_post_comp == 1) %>% nrow

# Monash
pre_9 <- patient_data %>% filter(admhospital == "Monash Medical Centre" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_9 <- patient_data %>% filter(admhospital == "Monash Medical Centre" & wabr_base_comp == 1) %>% nrow
pre_st_9 <- patient_data %>% filter(admhospital == "Monash Medical Centre" & scenario_base_comp == 1) %>% nrow
pre_saq_9 <- patient_data %>% filter(admhospital == "Monash Medical Centre" & saqol_base_comp == 1) %>% nrow
pre_ghq_9 <- patient_data %>% filter(admhospital == "Monash Medical Centre" & ghq12_base_comp == 1) %>% nrow

post_9 <- patient_data %>% filter(admhospital == "Monash Medical Centre" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_9 <- patient_data %>% filter(admhospital == "Monash Medical Centre" & wabr_post_comp == 1) %>% nrow
post_st_9 <- patient_data %>% filter(admhospital == "Monash Medical Centre" & scenario_post_comp == 1) %>% nrow
post_saq_9 <- patient_data %>% filter(admhospital == "Monash Medical Centre" & saqol_post_comp == 1) %>% nrow
post_ghq_9 <- patient_data %>% filter(admhospital == "Monash Medical Centre" & ghq12_post_comp == 1) %>% nrow

# Kingston
pre_10 <- patient_data %>% filter(admhospital == "Kingston Centre" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_10 <- patient_data %>% filter(admhospital == "Kingston Centre" & wabr_base_comp == 1) %>% nrow
pre_st_10 <- patient_data %>% filter(admhospital == "Kingston Centre" & scenario_base_comp == 1) %>% nrow
pre_saq_10 <- patient_data %>% filter(admhospital == "Kingston Centre" & saqol_base_comp == 1) %>% nrow
pre_ghq_10 <- patient_data %>% filter(admhospital == "Kingston Centre" & ghq12_base_comp == 1) %>% nrow

post_10 <- patient_data %>% filter(admhospital == "Kingston Centre" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_10 <- patient_data %>% filter(admhospital == "Kingston Centre" & wabr_post_comp == 1) %>% nrow
post_st_10 <- patient_data %>% filter(admhospital == "Kingston Centre" & scenario_post_comp == 1) %>% nrow
post_saq_10 <- patient_data %>% filter(admhospital == "Kingston Centre" & saqol_post_comp == 1) %>% nrow
post_ghq_10 <- patient_data %>% filter(admhospital == "Kingston Centre" & ghq12_post_comp == 1) %>% nrow

# Sir Charles
pre_11 <- patient_data %>% filter(admhospital == "Sir Charles Gairdner Hospital" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_11 <- patient_data %>% filter(admhospital == "Sir Charles Gairdner Hospital" & wabr_base_comp == 1) %>% nrow
pre_st_11 <- patient_data %>% filter(admhospital == "Sir Charles Gairdner Hospital" & scenario_base_comp == 1) %>% nrow
pre_saq_11 <- patient_data %>% filter(admhospital == "Sir Charles Gairdner Hospital" & saqol_base_comp == 1) %>% nrow
pre_ghq_11 <- patient_data %>% filter(admhospital == "Sir Charles Gairdner Hospital" & ghq12_base_comp == 1) %>% nrow

post_11 <- patient_data %>% filter(admhospital == "Sir Charles Gairdner Hospital" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_11 <- patient_data %>% filter(admhospital == "Sir Charles Gairdner Hospital" & wabr_post_comp == 1) %>% nrow
post_st_11 <- patient_data %>% filter(admhospital == "Sir Charles Gairdner Hospital" & scenario_post_comp == 1) %>% nrow
post_saq_11 <- patient_data %>% filter(admhospital == "Sir Charles Gairdner Hospital" & saqol_post_comp == 1) %>% nrow
post_ghq_11 <- patient_data %>% filter(admhospital == "Sir Charles Gairdner Hospital" & ghq12_post_comp == 1) %>% nrow

# Osborne
pre_12 <- patient_data %>% filter(admhospital == "Osborne Park Hospital" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_12 <- patient_data %>% filter(admhospital == "Osborne Park Hospital" & wabr_base_comp == 1) %>% nrow
pre_st_12 <- patient_data %>% filter(admhospital == "Osborne Park Hospital" & scenario_base_comp == 1) %>% nrow
pre_saq_12 <- patient_data %>% filter(admhospital == "Osborne Park Hospital" & saqol_base_comp == 1) %>% nrow
pre_ghq_12 <- patient_data %>% filter(admhospital == "Osborne Park Hospital" & ghq12_base_comp == 1) %>% nrow

post_12 <- patient_data %>% filter(admhospital == "Osborne Park Hospital" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_12 <- patient_data %>% filter(admhospital == "Osborne Park Hospital" & wabr_post_comp == 1) %>% nrow
post_st_12 <- patient_data %>% filter(admhospital == "Osborne Park Hospital" & scenario_post_comp == 1) %>% nrow
post_saq_12 <- patient_data %>% filter(admhospital == "Osborne Park Hospital" & saqol_post_comp == 1) %>% nrow
post_ghq_12 <- patient_data %>% filter(admhospital == "Osborne Park Hospital" & ghq12_post_comp == 1) %>% nrow

# Fiona
pre_13 <- patient_data %>% filter(admhospital == "Fiona Stanley Hospital" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_13 <- patient_data %>% filter(admhospital == "Fiona Stanley Hospital" & wabr_base_comp == 1) %>% nrow
pre_st_13 <- patient_data %>% filter(admhospital == "Fiona Stanley Hospital" & scenario_base_comp == 1) %>% nrow
pre_saq_13 <- patient_data %>% filter(admhospital == "Fiona Stanley Hospital" & saqol_base_comp == 1) %>% nrow
pre_ghq_13 <- patient_data %>% filter(admhospital == "Fiona Stanley Hospital" & ghq12_base_comp == 1) %>% nrow

post_13 <- patient_data %>% filter(admhospital == "Fiona Stanley Hospital" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_13 <- patient_data %>% filter(admhospital == "Fiona Stanley Hospital" & wabr_post_comp == 1) %>% nrow
post_st_13 <- patient_data %>% filter(admhospital == "Fiona Stanley Hospital" & scenario_post_comp == 1) %>% nrow
post_saq_13 <- patient_data %>% filter(admhospital == "Fiona Stanley Hospital" & saqol_post_comp == 1) %>% nrow
post_ghq_13 <- patient_data %>% filter(admhospital == "Fiona Stanley Hospital" & ghq12_post_comp == 1) %>% nrow

# Fremantle
pre_14 <- patient_data %>% filter(admhospital == "Fremantle Hospital" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_14 <- patient_data %>% filter(admhospital == "Fremantle Hospital" & wabr_base_comp == 1) %>% nrow
pre_st_14 <- patient_data %>% filter(admhospital == "Fremantle Hospital" & scenario_base_comp == 1) %>% nrow
pre_saq_14 <- patient_data %>% filter(admhospital == "Fremantle Hospital" & saqol_base_comp == 1) %>% nrow
pre_ghq_14 <- patient_data %>% filter(admhospital == "Fremantle Hospital" & ghq12_base_comp == 1) %>% nrow

post_14 <- patient_data %>% filter(admhospital == "Fremantle Hospital" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_14 <- patient_data %>% filter(admhospital == "Fremantle Hospital" & wabr_post_comp == 1) %>% nrow
post_st_14 <- patient_data %>% filter(admhospital == "Fremantle Hospital" & scenario_post_comp == 1) %>% nrow
post_saq_14 <- patient_data %>% filter(admhospital == "Fremantle Hospital" & saqol_post_comp == 1) %>% nrow
post_ghq_14 <- patient_data %>% filter(admhospital == "Fremantle Hospital" & ghq12_post_comp == 1) %>% nrow

# STARS Day Hospital
pre_15 <- patient_data %>% filter(admhospital == "STARS Day Hospital" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_15 <- patient_data %>% filter(admhospital == "STARS Day Hospital" & wabr_base_comp == 1) %>% nrow
pre_st_15 <- patient_data %>% filter(admhospital == "STARS Day Hospital" & scenario_base_comp == 1) %>% nrow
pre_saq_15 <- patient_data %>% filter(admhospital == "STARS Day Hospital" & saqol_base_comp == 1) %>% nrow
pre_ghq_15 <- patient_data %>% filter(admhospital == "STARS Day Hospital" & ghq12_base_comp == 1) %>% nrow

post_15 <- patient_data %>% filter(admhospital == "STARS Day Hospital" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_15 <- patient_data %>% filter(admhospital == "STARS Day Hospital" & wabr_post_comp == 1) %>% nrow
post_st_15 <- patient_data %>% filter(admhospital == "STARS Day Hospital" & scenario_post_comp == 1) %>% nrow
post_saq_15 <- patient_data %>% filter(admhospital == "STARS Day Hospital" & saqol_post_comp == 1) %>% nrow
post_ghq_15 <- patient_data %>% filter(admhospital == "STARS Day Hospital" & ghq12_post_comp == 1) %>% nrow

# Casey
pre_16 <- patient_data %>% filter(admhospital == "Casey Hospital" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_16 <- patient_data %>% filter(admhospital == "Casey Hospital" & wabr_base_comp == 1) %>% nrow
pre_st_16 <- patient_data %>% filter(admhospital == "Casey Hospital" & scenario_base_comp == 1) %>% nrow
pre_saq_16 <- patient_data %>% filter(admhospital == "Casey Hospital" & saqol_base_comp == 1) %>% nrow
pre_ghq_16 <- patient_data %>% filter(admhospital == "Casey Hospital" & ghq12_base_comp == 1) %>% nrow

post_16 <- patient_data %>% filter(admhospital == "Casey Hospital" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_16 <- patient_data %>% filter(admhospital == "Casey Hospital" & wabr_post_comp == 1) %>% nrow
post_st_16 <- patient_data %>% filter(admhospital == "Casey Hospital" & scenario_post_comp == 1) %>% nrow
post_saq_16 <- patient_data %>% filter(admhospital == "Casey Hospital" & saqol_post_comp == 1) %>% nrow
post_ghq_16 <- patient_data %>% filter(admhospital == "Casey Hospital" & ghq12_post_comp == 1) %>% nrow

# SVHM Rehab@Home
pre_17 <- patient_data %>% filter(admhospital == "SVHM - Rehab@Home" & wabr_base_comp == 1 & scenario_base_comp == 1 & saqol_base_comp == 1 & ghq12_base_comp == 1) %>% nrow
pre_wabr_17 <- patient_data %>% filter(admhospital == "SVHM - Rehab@Home" & wabr_base_comp == 1) %>% nrow
pre_st_17 <- patient_data %>% filter(admhospital == "SVHM - Rehab@Home" & scenario_base_comp == 1) %>% nrow
pre_saq_17 <- patient_data %>% filter(admhospital == "SVHM - Rehab@Home" & saqol_base_comp == 1) %>% nrow
pre_ghq_17 <- patient_data %>% filter(admhospital == "SVHM - Rehab@Home" & ghq12_base_comp == 1) %>% nrow

post_17 <- patient_data %>% filter(admhospital == "SVHM - Rehab@Home" & wabr_post_comp == 1 & scenario_post_comp == 1 & saqol_post_comp == 1 & ghq12_post_comp == 1) %>% nrow
post_wabr_17 <- patient_data %>% filter(admhospital == "SVHM - Rehab@Home" & wabr_post_comp == 1) %>% nrow
post_st_17 <- patient_data %>% filter(admhospital == "SVHM - Rehab@Home" & scenario_post_comp == 1) %>% nrow
post_saq_17 <- patient_data %>% filter(admhospital == "SVHM - Rehab@Home" & saqol_post_comp == 1) %>% nrow
post_ghq_17 <- patient_data %>% filter(admhospital == "SVHM - Rehab@Home" & ghq12_post_comp == 1) %>% nrow
```

<div style="text-align:right; font-size: 12px; color: gray;">
  Report generated on `r format(Sys.Date(), "%d %B %Y")`
</div>

# Recruitment summary
<!-- Display screened, recruited and completed participants summary cards -->

<div class="row w-row">

  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r total_screened`</h1>
  <div class="number-card-dollars">Participants screened</div>
  </div>
  </div>
  </div>

  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r total_recruited`</h1>
  <div class="number-card-dollars">Participants recruited</div>
  </div>
  </div>
  </div>

  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content3" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r completed_study`</h1>
  <div class="number-card-dollars">Completed study</div>
  </div>
  </div>
  </div>

``` {r recruitmentPlots, fig.width=10, fig.height=4}

# Combine Monash and SVHM sites
screening_data <- screening_data %>%
  mutate(screen_hospital_grouped = case_when(
    screen_hospital %in% c("Kingston Centre", "Monash Medical Centre") ~ "Monash Health",
    screen_hospital %in% c("St Vincent's Hospital Melbourne - Acute Fitzroy", "St Vincent's Hospital Melbourne - Rehab SGHS") ~ "SVHM",
    TRUE ~ screen_hospital  # Keep other hospital names as they are
  ))

months <- c("February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December")
sitePlotLabels <- c("Caboolture", "Fiona Stanley", "Monash", "Redcliffe", "RBWH", "STARS", "SVHM")
  
# create recruits per month plot
screening_data$today <- as.Date(screening_data$today)
screening_data <- screening_data %>% mutate(year_month = floor_date(today, "month"))
participants_per_month <- screening_data %>%
  filter(screening_data$gained_consent == 1) %>%
  group_by(year_month) %>%
  summarise(recruited_participants = n())

participantsByMonth_plot <- ggplot(participants_per_month, aes(x = year_month, y = recruited_participants)) +
  geom_bar(stat = "identity", width = 15, fill = wes_palette("Zissou1")[1]) +
  labs(title = "Recruited participants per month", x = NULL, y = "Number of Participants") +
  scale_y_continuous(breaks = scales::pretty_breaks(n = 6), limits = c(0, 12)) +
  scale_x_date(date_labels = "%b", date_breaks = "1 month") +
  theme_minimal() +
  theme(text = element_text(family = "Arial"), plot.title = element_text(size = 14, face = "bold", color = "gray45"), axis.title.y = element_text(color = "gray45"), axis.text.x = element_text(angle = 45, hjust = 1), panel.grid.minor = element_blank(), panel.grid.major.x = element_blank())


# create recruits per site plot
recruits_by_site <- screening_data %>%
  filter(screening_data$gained_consent == 1) %>%
  group_by(screen_hospital_grouped) %>%
  summarise(recruited_participants = n())

recruitsBySitePlot <- ggplot(recruits_by_site, aes(x = screen_hospital_grouped, y = recruited_participants)) +
  geom_bar(stat = "identity", width = .5, fill = wes_palette("Zissou1")[1]) +
  labs(title = "Recruited participants by screening site", x = NULL, y = NULL) +
  scale_y_continuous(breaks = scales::pretty_breaks(n = 6), limits = c(0, 12)) +
  scale_x_discrete(labels = sitePlotLabels) + 
  theme_minimal() +
  theme(text = element_text(family = "Arial"), plot.title = element_text(size = 14, face = "bold", color = "gray45"), axis.text.x = element_text(angle = 45, hjust = 1), panel.grid.minor = element_blank(), panel.grid.major.x = element_blank())

# Arrange the plots side by side and ensure they are the same size
participantsByMonth_plot <- participantsByMonth_plot + 
  theme(plot.margin = unit(c(1, 1, 1, 1), "cm"))  # Increase bottom margin for x-axis labels

recruitsBySitePlot <- recruitsBySitePlot + 
  theme(plot.margin = unit(c(1, 1, 0, 1), "cm"))  # Increase bottom margin for x-axis labels

grid.arrange(participantsByMonth_plot, recruitsBySitePlot, nrow = 1, ncol = 2)


```
</div>

<hr>

# Data collection summary
<!-- Display the number of completed COS measures, anchors and patient experience questionnaires across all sites -->

<div class="row w-row">

<!-- Pre cos -->
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <div class="number-card-dollars">Core outcomes</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front"><strong>Outcome</strong><br>WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress"><strong>Pre | Post</strong><br>`r cos_summary_table["Pre"][[1]][1]` | `r cos_summary_table["Post"][[1]][1]`<br>`r cos_summary_table["Pre"][[1]][2]` | `r cos_summary_table["Post"][[1]][2]`<br>`r cos_summary_table["Pre"][[1]][3]` | `r cos_summary_table["Post"][[1]][3]`<br>`r cos_summary_table["Pre"][[1]][4]` | `r cos_summary_table["Post"][[1]][4]`</div>
  </div>
  </div>
  </div>
  </div>
  
<!-- Clinician anchors -->
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <div class="number-card-dollars">Anchors</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front"><strong>Construct</strong><br>Language<br>Communication<br>QoL<br>Wellbeing</div>
  <div class="number-card-progress"><strong>Clinician | Patient</strong><br>`r anchor_summary_table["Clinician"][[1]][1]` | `r anchor_summary_table["Patient"][[1]][1]`<br>`r anchor_summary_table["Clinician"][[1]][2]` | `r anchor_summary_table["Patient"][[1]][2]`<br>`r anchor_summary_table["Clinician"][[1]][3]` | `r anchor_summary_table["Patient"][[1]][3]`<br>`r anchor_summary_table["Clinician"][[1]][4]` | `r anchor_summary_table["Patient"][[1]][4]`</div>
  </div>
  </div>
  </div>
  </div>
  
<!-- Experience survey -->
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r total_exp_survey`</h1>
  <div class="number-card-dollars">Experience surveys</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  
</div>

# Sites {.tabset .tabset-fade .tabset-pills }

## Queensland {.tabset .tabset-fade }

### RBWH {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][10]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_1`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_1`<br>`r pre_st_1`<br>`r pre_saq_1`<br>`r pre_ghq_1`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_1`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_1`<br>`r post_st_1`<br>`r post_saq_1`<br>`r post_ghq_1`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment COS
```{r, warning=FALSE, echo=FALSE}

royal_pre <- patient_data %>% filter( admhospital == "Royal Brisbane and Women's Hospital" )%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

royal_pre[royal_pre == 0] <- "Incomplete"
royal_pre[royal_pre == 2] <- "Complete"
colnames(royal_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_royal_pre <- SharedData$new(royal_pre)

royal_pre_dt <- datatable(shared_royal_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(royal_pre) ==0 ){
  royal_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_royal_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_royal_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_royal_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_royal_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_royal_pre, ~`Baseline GHQ`, inline = FALSE)),
  royal_pre_dt)
}

```
#### Post-treatment COS
```{r, warning=FALSE, echo=FALSE}

royal_post <- patient_data %>% filter(admhospital == "Royal Brisbane and Women's Hospital")%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

royal_post[royal_post == 0] <- "Incomplete"
royal_post[royal_post == 2] <- "Complete"
colnames(royal_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_royal_post <- SharedData$new(royal_post)

royal_post_dt <- datatable(shared_royal_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(royal_post) ==0 ){
  royal_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_royal_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_royal_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_royal_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_royal_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_royal_post, ~`Post GHQ`, inline = FALSE)),
  royal_post_dt)
}

```

### Caboolture {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][2]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_4`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_4`<br>`r pre_st_4`<br>`r pre_saq_4`<br>`r pre_ghq_4`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_4`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_4`<br>`r post_st_4`<br>`r post_saq_4`<br>`r post_ghq_4`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

Caboolture_pre <- patient_data %>% filter( admhospital == "Caboolture Hospital" )%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

Caboolture_pre[Caboolture_pre == 0] <- "Incomplete"
Caboolture_pre[Caboolture_pre == 2] <- "Complete"
colnames(Caboolture_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_Caboolture_pre <- SharedData$new(Caboolture_pre)

Caboolture_pre_dt <- datatable(shared_Caboolture_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(Caboolture_pre) ==0 ){
  Caboolture_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Caboolture_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_Caboolture_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_Caboolture_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_Caboolture_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_Caboolture_pre, ~`Baseline GHQ`, inline = FALSE)),
  Caboolture_pre_dt)
}

```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

Caboolture_post <- patient_data %>% filter(admhospital == "Caboolture Hospital")%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

Caboolture_post[Caboolture_post == 0] <- "Incomplete"
Caboolture_post[Caboolture_post == 2] <- "Complete"
colnames(Caboolture_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_Caboolture_post <- SharedData$new(Caboolture_post)

Caboolture_post_dt <- datatable(shared_Caboolture_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(Caboolture_post) ==0 ){
  Caboolture_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Caboolture_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_Caboolture_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_Caboolture_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_Caboolture_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_Caboolture_post, ~`Post GHQ`, inline = FALSE)),
  Caboolture_post_dt)
}

```

### STARS {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][16]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_2`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_2`<br>`r pre_st_2`<br>`r pre_saq_2`<br>`r pre_ghq_2`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_2`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_2`<br>`r post_st_2`<br>`r post_saq_2`<br>`r post_ghq_2`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

surgical_pre <- patient_data %>% filter(admhospital == "Surgical, Treatment and Rehabilitation Service")%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

surgical_pre[surgical_pre == 0] <- "Incomplete"
surgical_pre[surgical_pre == 2] <- "Complete"
colnames(surgical_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_surgical_pre <- SharedData$new(surgical_pre)

surgical_pre_dt <- datatable(shared_surgical_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(surgical_pre) ==0 ){
  surgical_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_surgical_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_surgical_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_surgical_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_surgical_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_surgical_pre, ~`Baseline GHQ`, inline = FALSE)),
  surgical_pre_dt)
}

```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

surgical_post <- patient_data %>% filter(admhospital == "Surgical, Treatment and Rehabilitation Service")%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

surgical_post[surgical_post == 0] <- "Incomplete"
surgical_post[surgical_post == 2] <- "Complete"
colnames(surgical_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_surgical_post <- SharedData$new(surgical_post)

surgical_post_dt <- datatable(shared_surgical_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(surgical_post) ==0 ){
  surgical_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_surgical_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_surgical_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_surgical_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_surgical_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_surgical_post, ~`Post GHQ`, inline = FALSE)),
  surgical_post_dt)
}

```

### STARS Day Hospital {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][15]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_15`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_15`<br>`r pre_st_15`<br>`r pre_saq_15`<br>`r pre_ghq_15`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_15`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_15`<br>`r post_st_15`<br>`r post_saq_15`<br>`r post_ghq_15`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

STARS_DH_pre <- patient_data %>% filter(admhospital == "STARS Day Hospital")%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

STARS_DH_pre[STARS_DH_pre == 0] <- "Incomplete"
STARS_DH_pre[STARS_DH_pre == 2] <- "Complete"
colnames(STARS_DH_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_STARS_DH_pre <- SharedData$new(STARS_DH_pre)

STARS_DH_pre_dt <- datatable(shared_STARS_DH_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(STARS_DH_pre) ==0 ){
  STARS_DH_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_STARS_DH_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_STARS_DH_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_STARS_DH_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_STARS_DH_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_STARS_DH_pre, ~`Baseline GHQ`, inline = FALSE)),
  STARS_DH_pre_dt)
}

```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

STARS_DH_post <- patient_data %>% filter(admhospital == "STARS Day Hospital")%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

STARS_DH_post[STARS_DH_post == 0] <- "Incomplete"
STARS_DH_post[STARS_DH_post == 2] <- "Complete"
colnames(STARS_DH_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_STARS_DH_post <- SharedData$new(STARS_DH_post)

STARS_DH_post_dt <- datatable(shared_STARS_DH_post, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(STARS_DH_post) ==0 ){
  STARS_DH_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_STARS_DH_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_STARS_DH_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_STARS_DH_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_STARS_DH_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_STARS_DH_post, ~`Post GHQ`, inline = FALSE)),
  STARS_DH_post_dt)
}

```

### Redcliffe {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][9]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_5`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_5`<br>`r pre_st_5`<br>`r pre_saq_5`<br>`r pre_ghq_5`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_5`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_5`<br>`r post_st_5`<br>`r post_saq_5`<br>`r post_ghq_5`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

Redcliffe_pre <- patient_data %>% filter( admhospital == "Redcliffe Hospital" )%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

Redcliffe_pre[Redcliffe_pre == 0] <- "Incomplete"
Redcliffe_pre[Redcliffe_pre == 2] <- "Complete"
colnames(Redcliffe_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_Redcliffe_pre <- SharedData$new(Redcliffe_pre)

Redcliffe_pre_dt <- datatable(shared_Redcliffe_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(Redcliffe_pre) ==0 ){
  Redcliffe_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Redcliffe_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_Redcliffe_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_Redcliffe_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_Redcliffe_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_Redcliffe_pre, ~`Baseline GHQ`, inline = FALSE)),
  Redcliffe_pre_dt)
}

```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

Redcliffe_post <- patient_data %>% filter(admhospital == "Redcliffe Hospital")%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

Redcliffe_post[Redcliffe_post == 0] <- "Incomplete"
Redcliffe_post[Redcliffe_post == 2] <- "Complete"
colnames(Redcliffe_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_Redcliffe_post <- SharedData$new(Redcliffe_post)

Redcliffe_post_dt <- datatable(shared_Redcliffe_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(Redcliffe_post) ==0 ){
  Redcliffe_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Redcliffe_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_Redcliffe_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_Redcliffe_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_Redcliffe_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_Redcliffe_post, ~`Post GHQ`, inline = FALSE)),
  Redcliffe_post_dt)
}

```

### Brighton {.tabset .tabset-fade} 

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][1]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_3`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_3`<br>`r pre_st_3`<br>`r pre_saq_3`<br>`r pre_ghq_3`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_3`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_3`<br>`r post_st_3`<br>`r post_saq_3`<br>`r post_ghq_3`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

Brighton_pre <- patient_data %>% filter( admhospital == "Brighton Rehabilitation Unit" )%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

Brighton_pre[Brighton_pre == 0] <- "Incomplete"
Brighton_pre[Brighton_pre == 2] <- "Complete"
colnames(Brighton_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_Brighton_pre <- SharedData$new(Brighton_pre)

Brighton_pre_dt <- datatable(shared_Brighton_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(Brighton_pre) ==0 ){
  Brighton_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Brighton_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_Brighton_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_Brighton_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_Brighton_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_Brighton_pre, ~`Baseline GHQ`, inline = FALSE)),
  Brighton_pre_dt)
}

```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

Brighton_post <- patient_data %>% filter(admhospital == "Brighton Rehabilitation Unit")%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

Brighton_post[Brighton_post == 0] <- "Incomplete"
Brighton_post[Brighton_post == 2] <- "Complete"
colnames(Brighton_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_Brighton_post <- SharedData$new(Brighton_post)

Brighton_post_dt <- datatable(shared_Brighton_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(Brighton_post) ==0 ){
  Brighton_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Brighton_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_Brighton_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_Brighton_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_Brighton_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_Brighton_post, ~`Post GHQ`, inline = FALSE)),
  Brighton_post_dt)
}

```

## Victoria {.tabset .tabset-fade }

### SVHM - Acute {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][12]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_6`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_6`<br>`r pre_st_6`<br>`r pre_saq_6`<br>`r pre_ghq_6`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_6`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_6`<br>`r post_st_6`<br>`r post_saq_6`<br>`r post_ghq_6`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

StAF_pre <- patient_data %>% filter( admhospital == "St Vincent's Hospital Melbourne - Acute Fitzroy" )%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

StAF_pre[StAF_pre == 0] <- "Incomplete"
StAF_pre[StAF_pre == 2] <- "Complete"
colnames(StAF_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_StAF_pre <- SharedData$new(StAF_pre)

StAF_pre_dt <- datatable(shared_StAF_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(StAF_pre) ==0 ){
  StAF_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_StAF_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_StAF_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_StAF_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_StAF_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_StAF_pre, ~`Baseline GHQ`, inline = FALSE)),
  StAF_pre_dt)
}

```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

StAF_post <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Acute Fitzroy")%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

StAF_post[StAF_post == 0] <- "Incomplete"
StAF_post[StAF_post == 2] <- "Complete"
colnames(StAF_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_StAF_post <- SharedData$new(StAF_post)

StAF_post_dt <- datatable(shared_StAF_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(StAF_post) ==0 ){
  StAF_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_StAF_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_StAF_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_StAF_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_StAF_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_StAF_post, ~`Post GHQ`, inline = FALSE)),
  StAF_post_dt)
}

```

### SVHM - Rehab Fitzroy {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][13]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_7`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_7`<br>`r pre_st_7`<br>`r pre_saq_7`<br>`r pre_ghq_7`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_7`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_7`<br>`r post_st_7`<br>`r post_saq_7`<br>`r post_ghq_7`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

StRF_pre <- patient_data %>% filter( admhospital == "St Vincent's Hospital Melbourne - Rehab Fitzroy" )%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

StRF_pre[StRF_pre == 0] <- "Incomplete"
StRF_pre[StRF_pre == 2] <- "Complete"
colnames(StRF_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_StRF_pre <- SharedData$new(StRF_pre)

StRF_pre_dt <- datatable(shared_StRF_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(StRF_pre) ==0 ){
  StRF_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_StRF_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_StRF_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_StRF_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_StRF_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_StRF_pre, ~`Baseline GHQ`, inline = FALSE)),
  StRF_pre_dt)
}

```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

StRF_post <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab Fitzroy")%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

StRF_post[StRF_post == 0] <- "Incomplete"
StRF_post[StRF_post == 2] <- "Complete"
colnames(StRF_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_StRF_post <- SharedData$new(StRF_post)

StRF_post_dt <- datatable(shared_StRF_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(StRF_post) ==0 ){
  StRF_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_StRF_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_StRF_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_StRF_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_StRF_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_StRF_post, ~`Post GHQ`, inline = FALSE)),
  StRF_post_dt)
}

```

### SVHM - Rehab SGHS {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][14]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_8`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_8`<br>`r pre_st_8`<br>`r pre_saq_8`<br>`r pre_ghq_8`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_8`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_8`<br>`r post_st_8`<br>`r post_saq_8`<br>`r post_ghq_8`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

SGHS_pre <- patient_data %>% filter( admhospital == "St Vincent's Hospital Melbourne - Rehab SGHS" )%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

SGHS_pre[SGHS_pre == 0] <- "Incomplete"
SGHS_pre[SGHS_pre == 2] <- "Complete"
colnames(SGHS_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_SGHS_pre <- SharedData$new(SGHS_pre)

SGHS_pre_dt <- datatable(shared_SGHS_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(SGHS_pre) ==0 ){
  SGHS_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_SGHS_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_SGHS_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_SGHS_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_SGHS_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_SGHS_pre, ~`Baseline GHQ`, inline = FALSE)),
  SGHS_pre_dt)
}

```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

SGHS_post <- patient_data %>% filter(admhospital == "St Vincent's Hospital Melbourne - Rehab SGHS")%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

SGHS_post[SGHS_post == 0] <- "Incomplete"
SGHS_post[SGHS_post == 2] <- "Complete"
colnames(SGHS_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_SGHS_post <- SharedData$new(SGHS_post)

SGHS_post_dt <- datatable(shared_SGHS_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(SGHS_post) ==0 ){
  SGHS_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_SGHS_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_SGHS_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_SGHS_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_SGHS_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_SGHS_post, ~`Post GHQ`, inline = FALSE)),
  SGHS_post_dt)
}

```

### SVHM - Rehab@Home {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][17]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_17`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_17`<br>`r pre_st_17`<br>`r pre_saq_17`<br>`r pre_ghq_17`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_17`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_17`<br>`r post_st_17`<br>`r post_saq_17`<br>`r post_ghq_17`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

SVHome_pre <- patient_data %>% filter( admhospital == "SVHM - Rehab@Home" )%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

SVHome_pre[SVHome_pre == 0] <- "Incomplete"
SVHome_pre[SVHome_pre == 2] <- "Complete"
colnames(SVHome_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_SVHome_pre <- SharedData$new(SVHome_pre)

SVHome_pre_dt <- datatable(shared_SVHome_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(SVHome_pre) ==0 ){
  SVHome_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_SVHome_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_SVHome_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_SVHome_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_SVHome_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_SVHome_pre, ~`Baseline GHQ`, inline = FALSE)),
  SVHome_pre_dt)
}

```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

SVHome_post <- patient_data %>% filter(admhospital == "SVHM - Rehab@Home")%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

SVHome_post[SVHome_post == 0] <- "Incomplete"
SVHome_post[SVHome_post == 2] <- "Complete"
colnames(SVHome_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_SVHome_post <- SharedData$new(SVHome_post)

SVHome_post_dt <- datatable(shared_SVHome_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(SVHome_post) ==0 ){
  SVHome_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_SVHome_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_SVHome_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_SVHome_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_SVHome_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_SVHome_post, ~`Post GHQ`, inline = FALSE)),
  SVHome_post_dt)
}

```

### Monash Medical Centre {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][7]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_9`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_9`<br>`r pre_st_9`<br>`r pre_saq_9`<br>`r pre_ghq_9`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_9`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_9`<br>`r post_st_9`<br>`r post_saq_9`<br>`r post_ghq_9`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

Monash_pre <- patient_data %>% filter( admhospital == "Monash Medical Centre" )%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

Monash_pre[Monash_pre == 0] <- "Incomplete"
Monash_pre[Monash_pre == 2] <- "Complete"
colnames(Monash_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_Monash_pre <- SharedData$new(Monash_pre)

Monash_pre_dt <- datatable(shared_Monash_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(Monash_pre) ==0 ){
  Monash_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Monash_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_Monash_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_Monash_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_Monash_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_Monash_pre, ~`Baseline GHQ`, inline = FALSE)),
  Monash_pre_dt)
}

```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

Monash_post <- patient_data %>% filter(admhospital == "Monash Medical Centre")%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

Monash_post[Monash_post == 0] <- "Incomplete"
Monash_post[Monash_post == 2] <- "Complete"
colnames(Monash_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_Monash_post <- SharedData$new(Monash_post)

Monash_post_dt <- datatable(shared_Monash_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(Monash_post) ==0 ){
  Monash_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Monash_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_Monash_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_Monash_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_Monash_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_Monash_post, ~`Post GHQ`, inline = FALSE)),
  Monash_post_dt)
}

```

### Kingston Centre {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][6]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_10`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_10`<br>`r pre_st_10`<br>`r pre_saq_10`<br>`r pre_ghq_10`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_10`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_10`<br>`r post_st_10`<br>`r post_saq_10`<br>`r post_ghq_10`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

Kingston_pre <- patient_data %>% filter( admhospital == "Kingston Centre" )%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

Kingston_pre[Kingston_pre == 0] <- "Incomplete"
Kingston_pre[Kingston_pre == 2] <- "Complete"
colnames(Kingston_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_Kingston_pre <- SharedData$new(Kingston_pre)

Kingston_pre_dt <- datatable(shared_Kingston_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(Kingston_pre) ==0 ){
  Kingston_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Kingston_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_Kingston_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_Kingston_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_Kingston_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_Kingston_pre, ~`Baseline GHQ`, inline = FALSE)),
  Kingston_pre_dt)
}

```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

Kingston_post <- patient_data %>% filter(admhospital == "Kingston Centre")%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

Kingston_post[Kingston_post == 0] <- "Incomplete"
Kingston_post[Kingston_post == 2] <- "Complete"
colnames(Kingston_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_Kingston_post <- SharedData$new(Kingston_post)

Kingston_post_dt <- datatable(shared_Kingston_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(Kingston_post) ==0 ){
  Kingston_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Kingston_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_Kingston_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_Kingston_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_Kingston_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_Kingston_post, ~`Post GHQ`, inline = FALSE)),
  Kingston_post_dt)
}

```

### Casey {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][3]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_16`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_16`<br>`r pre_st_16`<br>`r pre_saq_16`<br>`r pre_ghq_16`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_16`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_16`<br>`r post_st_16`<br>`r post_saq_16`<br>`r post_ghq_16`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

Casey_pre <- patient_data %>% filter( admhospital == "Casey Hospital" )%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

Casey_pre[Casey_pre == 0] <- "Incomplete"
Casey_pre[Casey_pre == 2] <- "Complete"
colnames(Casey_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_Casey_pre <- SharedData$new(Casey_pre)

Casey_pre_dt <- datatable(shared_Casey_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(Casey_pre) ==0 ){
  Casey_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Casey_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_Casey_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_Casey_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_Casey_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_Casey_pre, ~`Baseline GHQ`, inline = FALSE)),
  Casey_pre_dt)
}

```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

Casey_post <- patient_data %>% filter(admhospital == "Casey Hospital")%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

Casey_post[Casey_post == 0] <- "Incomplete"
Casey_post[Casey_post == 2] <- "Complete"
colnames(Casey_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_Casey_post <- SharedData$new(Casey_post)

Casey_post_dt <- datatable(shared_Casey_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(Casey_post) ==0 ){
  Casey_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Casey_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_Casey_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_Casey_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_Casey_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_Casey_post, ~`Post GHQ`, inline = FALSE)),
  Casey_post_dt)
}

```

## Western Australia {.tabset .tabset-fade }

### Sir Charles Gairdner {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][11]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_11`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_11`<br>`r pre_st_11`<br>`r pre_saq_11`<br>`r pre_ghq_11`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_11`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_11`<br>`r post_st_11`<br>`r post_saq_11`<br>`r post_ghq_11`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

Sir_pre <- patient_data %>% filter( admhospital == "Sir Charles Gairdner Hospital" )%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

Sir_pre[Sir_pre == 0] <- "Incomplete"
Sir_pre[Sir_pre == 2] <- "Complete"
colnames(Sir_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_Sir_pre <- SharedData$new(Sir_pre)

Sir_pre_dt <- datatable(shared_Sir_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(Sir_pre) ==0 ){
  Sir_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Sir_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_Sir_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_Sir_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_Sir_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_Sir_pre, ~`Baseline GHQ`, inline = FALSE)),
  Sir_pre_dt)
}


```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

Sir_post <- patient_data %>% filter(admhospital == "Sir Charles Gairdner Hospital" )%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

Sir_post[Sir_post == 0] <- "Incomplete"
Sir_post[Sir_post == 2] <- "Complete"
colnames(Sir_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_Sir_post <- SharedData$new(Sir_post)

Sir_post_dt <- datatable(shared_Sir_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(Sir_post) ==0 ){
  Sir_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Sir_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_Sir_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_Sir_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_Sir_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_Sir_post, ~`Post GHQ`, inline = FALSE)),
  Sir_post_dt)
}

```

### Osborne Park {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][8]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_12`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_12`<br>`r pre_st_12`<br>`r pre_saq_12`<br>`r pre_ghq_12`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_12`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_12`<br>`r post_st_12`<br>`r post_saq_12`<br>`r post_ghq_12`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

Osborne_pre <- patient_data %>% filter( admhospital == "Osborne Park Hospital" )%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

Osborne_pre[Osborne_pre == 0] <- "Incomplete"
Osborne_pre[Osborne_pre == 2] <- "Complete"
colnames(Osborne_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_Osborne_pre <- SharedData$new(Osborne_pre)

Osborne_pre_dt <- datatable(shared_Osborne_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(Osborne_pre) ==0 ){
  Osborne_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Osborne_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_Osborne_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_Osborne_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_Osborne_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_Osborne_pre, ~`Baseline GHQ`, inline = FALSE)),
  Osborne_pre_dt)
}

```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

Osborne_post <- patient_data %>% filter(admhospital == "Osborne Park Hospital" )%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

Osborne_post[Osborne_post == 0] <- "Incomplete"
Osborne_post[Osborne_post == 2] <- "Complete"
colnames(Osborne_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_Osborne_post <- SharedData$new(Osborne_post)

Osborne_post_dt <- datatable(shared_Osborne_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(Osborne_post) ==0 ){
  Osborne_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Osborne_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_Osborne_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_Osborne_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_Osborne_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_Osborne_post, ~`Post GHQ`, inline = FALSE)),
  Osborne_post_dt)
}

```

### Fiona Stanley {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][4]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_13`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_13`<br>`r pre_st_13`<br>`r pre_saq_13`<br>`r pre_ghq_13`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_13`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_13`<br>`r post_st_13`<br>`r post_saq_13`<br>`r post_ghq_13`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

Fiona_pre <- patient_data %>% filter( admhospital == "Fiona Stanley Hospital" )%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

Fiona_pre[Fiona_pre == 0] <- "Incomplete"
Fiona_pre[Fiona_pre == 2] <- "Complete"
colnames(Fiona_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_Fiona_pre <- SharedData$new(Fiona_pre)

Fiona_pre_dt <- datatable(shared_Fiona_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(Fiona_pre) ==0 ){
  Fiona_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Fiona_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_Fiona_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_Fiona_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_Fiona_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_Fiona_pre, ~`Baseline GHQ`, inline = FALSE)),
  Fiona_pre_dt)
}

```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

Fiona_post <- patient_data %>% filter(admhospital == "Fiona Stanley Hospital")%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

Fiona_post[Fiona_post == 0] <- "Incomplete"
Fiona_post[Fiona_post == 2] <- "Complete"
colnames(Fiona_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_Fiona_post <- SharedData$new(Fiona_post)

Fiona_post_dt <- datatable(shared_Fiona_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(Fiona_post) ==0 ){
  Fiona_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Fiona_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_Fiona_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_Fiona_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_Fiona_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_Fiona_post, ~`Post GHQ`, inline = FALSE)),
  Fiona_post_dt)
}

```

### Fremantle {.tabset .tabset-fade}

<div class="row w-row">
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content1" style="cursor:pointer;">
  <h1 class="number-card-number" style="text-align:left;">`r site_count["all"][[1]][5]`</h1>
  <div class="number-card-dollars">Total Patients</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r pre_14`</h1>
  <div class="number-card-dollars">Pre-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r pre_wabr_14`<br>`r pre_st_14`<br>`r pre_saq_14`<br>`r pre_ghq_14`</div>
  </div>
  </div>
  </div>
  </div>
  <div class="basic-column w-col w-col-3">
  <div class="tag-wrapper">
  <div class="number-card number-card-content4" style="cursor:pointer;">
  <h1 class="number-card-number">`r post_14`</h1>
  <div class="number-card-dollars">Post-treatment Completed</div>
  <div class="number-card-divider"></div>
  <div class="number-card-progress-wrapper">
  <div class="number-card-front">WABR<br>Scenario Test<br>SAQoL<br>GHQ</div>
  <div class="number-card-progress">`r post_wabr_14`<br>`r post_st_14`<br>`r post_saq_14`<br>`r post_ghq_14`</div>
  </div>
  </div>
  </div>
  </div>
</div>

<H1>Data verification table</H1>
<p>'Complete' indicates the relevant REDCap record contains data, not necessarily that the outcome measure has been administered.</p>

#### Pre-treatment Data
```{r, warning=FALSE, echo=FALSE}

Fremantle_pre <- patient_data %>% filter( admhospital == "Fremantle Hospital" )%>% select("participant_id","redcap_event_name", "baseline_wabr_complete","baseline_scenario_test_complete", "baseline_saqol39_complete", "baseline_ghq12_complete") 

Fremantle_pre[Fremantle_pre == 0] <- "Incomplete"
Fremantle_pre[Fremantle_pre == 2] <- "Complete"
colnames(Fremantle_pre) <- c("Participant ID", "Arm","Baseline WABR", "Baseline Scenario", "Baseline SAQoL", "Baseline GHQ")

shared_Fremantle_pre <- SharedData$new(Fremantle_pre)

Fremantle_pre_dt <- datatable(shared_Fremantle_pre, caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 
  
if (nrow(Fremantle_pre) ==0 ){
  Fremantle_pre_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Fremantle_pre, ~Arm, inline = FALSE),
       filter_checkbox("Baseline WABR", "WABR", shared_Fremantle_pre, ~`Baseline WABR`, inline = FALSE),
       filter_checkbox("Baseline Scenario", "Scenario Test", shared_Fremantle_pre, ~`Baseline Scenario`, inline = FALSE),
       filter_checkbox("Baseline SAQoL", "SAQoL", shared_Fremantle_pre, ~`Baseline SAQoL`, inline = FALSE),
       filter_checkbox("Baseline GHQ", "GHQ", shared_Fremantle_pre, ~`Baseline GHQ`, inline = FALSE)),
  Fremantle_pre_dt)
}

```
#### Post-treatment Data
```{r, warning=FALSE, echo=FALSE}

Fremantle_post <- patient_data %>% filter(admhospital == "Fremantle Hospital" )%>% select("participant_id","redcap_event_name","post_wabr_complete","post_scenario_test_complete","post_saqol39_complete", "post_ghq12_complete")

Fremantle_post[Fremantle_post == 0] <- "Incomplete"
Fremantle_post[Fremantle_post == 2] <- "Complete"
colnames(Fremantle_post) <- c("Participant ID", "Arm", "Post WABR", "Post Scenario", "Post SAQoL", "Post GHQ")

shared_Fremantle_post <- SharedData$new(Fremantle_post)

Fremantle_post_dt <- datatable(shared_Fremantle_post , caption = paste("Last updated: ",format(Sys.Date(), "%d-%m-%Y")), 
          rownames=FALSE,
          options = list(initComplete = JS("function(settings, json) {",
    "$(this.api().table().header()).css({'background-color': '#2266aa', 'color': '#fff'});","}"),
    columnDefs =list(list(className = 'dt-center', targets="_all")), pageLength =25 ,
                     lengthMenu =list(c(25,50,100,-1), c("25","50","100","ALL")) ,autoWidth = TRUE)) 

if (nrow(Fremantle_post) ==0 ){
  Fremantle_post_dt
} else{
  bscols(
    widths = c(2,NA,NA),
  list(filter_checkbox("Arm", "Arm", shared_Fremantle_post, ~Arm, inline = FALSE),
       filter_checkbox("Post WABR", "WABR", shared_Fremantle_post, ~`Post WABR`, inline = FALSE),
       filter_checkbox("Post Scenario", "Scenario Test", shared_Fremantle_post, ~`Post Scenario`, inline = FALSE),
       filter_checkbox("Post SAQoL", "SAQoL", shared_Fremantle_post, ~`Post SAQoL`, inline = FALSE),
       filter_checkbox("Post GHQ", "GHQ", shared_Fremantle_post, ~`Post GHQ`, inline = FALSE)),
  Fremantle_post_dt)
}

```

